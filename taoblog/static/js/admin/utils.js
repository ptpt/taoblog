// Generated by CoffeeScript 1.6.3
(function() {
  define(['jquery', 'admin/dom'], function($, dom) {
    var flash, truncate;
    truncate = function(text, length, killwords, end) {
      var index, whitespace, _i, _ref, _ref1;
      if (length == null) {
        length = 255;
      }
      if (killwords == null) {
        killwords = false;
      }
      if (end == null) {
        end = '...';
      }
      if (text.length <= length) {
        return text;
      }
      if (killwords) {
        return text.slice(0, +(length - 1) + 1 || 9e9) + end;
      }
      for (index = _i = length, _ref = length / 2; length <= _ref ? _i <= _ref : _i >= _ref; index = length <= _ref ? ++_i : --_i) {
        if ((_ref1 = text[index]) === '\n' || _ref1 === '\t' || _ref1 === ' ') {
          whitespace = true;
        } else if (whitespace) {
          return text.slice(0, +(index - 1) + 1 || 9e9) + end;
        }
      }
      return text.slice(0, +(index - 1) + 1 || 9e9) + end;
    };
    flash = function(message, category) {
      var item;
      if (category == null) {
        category = 'success';
      }
      item = dom([
        'p', {
          "class": category
        }, message
      ]);
      $('#flash').append(item);
      $(item).hide();
      return $(item).fadeIn('fast').delay(category === 'success' ? 3000 : 6000).fadeOut('slow', function() {
        return $(this).remove();
      });
    };
    return {
      truncate: truncate,
      flash: flash
    };
  });

}).call(this);
